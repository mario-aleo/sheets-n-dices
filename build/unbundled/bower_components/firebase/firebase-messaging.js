try{webpackJsonpFirebase([3],{117:function(a,b,c){c(118)},118:function(q,e,t){"use strict";function r(a){var b=new Uint8Array(a);return window.btoa(String.fromCharCode.apply(null,b))}function o(a){if(a.objectStoreNames.contains(y)){var c=a.transaction(y),d=c.objectStore(y),e=new b,f=d.openCursor();f.onerror=function(a){console.warn("Unable to cleanup old IDB.",a)},f.onsuccess=function(){var b=f.result;if(b){var c=b.value;e.deleteToken(c.fcmSenderId,c.fcmToken,c.fcmPushSet),b.continue()}else a.close(),indexedDB.deleteDatabase(m)}}}function n(){var a=indexedDB.open(m);a.onerror=function(){},a.onsuccess=function(){o(a.result)}}function i(){}function s(a){a.INTERNAL.registerService("messaging",function(a){return self&&"ServiceWorkerGlobalScope"in self?new G(a):new O(a)},{Messaging:O})}Object.defineProperty(e,"__esModule",{value:!0});var a,c=t(2),u=t(0),w={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},x=(a={},a[w.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",a[w.AVAILABLE_IN_SW]="This method is available in a service worker context.",a["should-be-overriden"]="This method should be overriden by extended classes.",a["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",a["permission-default"]="The required permissions were not granted and dismissed instead.",a["permission-blocked"]="The required permissions were not granted and blocked instead.",a["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",a["notifications-blocked"]="Notifications have been blocked.",a[w.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",a["sw-registration-expected"]="A service worker registration was the expected input.",a["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",a["invalid-saved-token"]="Unable to access details of the saved token.",a["sw-reg-redundant"]="The service worker being used for push was made redundant.",a["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$message}",a["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",a["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",a["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$message}",a["token-update-failed"]="A problem occured while updating the user from FCM: {$message}",a["token-update-no-token"]="FCM returned no token when updating the user to push.",a["use-sw-before-get-token"]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",a["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",a["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",a["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",a["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",a["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",a["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",a["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",a["failed-to-delete-token"]="Unable to delete the currently saved token.",a["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",a["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",a["bad-scope"]="The service worker scope must be a string with at least one character.",a["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",a["bad-subscription"]="The subscription must be a valid PushSubscription.",a["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",a["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",a["failed-delete-vapid-key"]="The VAPID key could not be deleted.",a["invalid-public-vapid-key"]="The public VAPID key must be a string.",a[w.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",a),z={codes:w,map:x},f=function(){function a(a,b){this.e=new u.ErrorFactory("messaging","Messaging",z.map),this.t=a,this.r=b,this.o=null,this.TRANSACTION_READ_WRITE="readwrite"}return a.prototype.openDatabase=function(){var a=this;return this.o?this.o:(this.o=new Promise(function(b,c){var d=indexedDB.open(a.t,a.r);d.onerror=function(a){c(a.target.error)},d.onsuccess=function(a){b(a.target.result)},d.onupgradeneeded=function(b){try{var d=b.target.result;a.onDBUpgrade(d,b)}catch(a){d.close(),c(a)}}}),this.o)},a.prototype.closeDatabase=function(){var a=this;return Promise.resolve().then(function(){if(a.o)return a.o.then(function(b){b.close(),a.o=null})})},a.prototype.onDBUpgrade=function(){throw this.e.create(z.codes.SHOULD_BE_INHERITED)},a}(),h=f,l=function(a){return r(a).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},g=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),B={DEFAULT_PUBLIC_VAPID_KEY:g,SUBSCRIPTION_DETAILS:{userVisibleOnly:!0,applicationServerKey:g},ENDPOINT:"https://fcm.googleapis.com"},D=function(){function a(){this.e=new u.ErrorFactory("messaging","Messaging",z.map)}return a.prototype.getToken=function(b,d,e){var f=this,g=l(d.getKey("p256dh")),h=l(d.getKey("auth")),i="authorized_entity="+b+"&endpoint="+d.endpoint+"&encryption_key="+g+"&encryption_auth="+h;e!==B.DEFAULT_PUBLIC_VAPID_KEY&&(i+="&application_pub_key="+l(e));var j=new Headers;j.append("Content-Type","application/x-www-form-urlencoded");var k={method:"POST",headers:j,body:i};return fetch(B.ENDPOINT+"/fcm/connect/subscribe",k).then(function(a){return a.json()}).catch(function(){throw f.e.create(z.codes.TOKEN_SUBSCRIBE_FAILED)}).then(function(a){var b=a;if(b.error){var c=b.error.message;throw f.e.create(z.codes.TOKEN_SUBSCRIBE_FAILED,{message:c})}if(!b.token)throw f.e.create(z.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!b.pushSet)throw f.e.create(z.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:b.token,pushSet:b.pushSet}})},a.prototype.updateToken=function(b,e,f,g,h){var j=this,i=l(g.getKey("p256dh")),k=l(g.getKey("auth")),a="push_set="+f+"&token="+e+"&authorized_entity="+b+"&endpoint="+g.endpoint+"&encryption_key="+i+"&encryption_auth="+k;h!==B.DEFAULT_PUBLIC_VAPID_KEY&&(a+="&application_pub_key="+l(h));var m=new Headers;m.append("Content-Type","application/x-www-form-urlencoded");var n,o={method:"POST",headers:m,body:a};return fetch(B.ENDPOINT+"/fcm/connect/subscribe",o).then(function(a){return n=a,a.json()}).catch(function(){throw j.e.create(z.codes.TOKEN_UPDATE_FAILED)}).then(function(a){if(!n.ok){var b=a.error.message;throw j.e.create(z.codes.TOKEN_UPDATE_FAILED,{message:b})}if(!a.token)throw j.e.create(z.codes.TOKEN_UPDATE_NO_TOKEN);return a.token})},a.prototype.deleteToken=function(a,b,c){var d=this,e=new Headers;e.append("Content-Type","application/x-www-form-urlencoded");return fetch(B.ENDPOINT+"/fcm/connect/unsubscribe",{method:"POST",headers:e,body:"authorized_entity="+a+"&token="+b+"&pushSet="+c}).then(function(a){if(!a.ok)return a.json().then(function(a){if(a.error){var b=a.error.message;throw d.e.create(z.codes.TOKEN_UNSUBSCRIBE_FAILED,{message:b})}},function(){throw d.e.create(z.codes.TOKEN_UNSUBSCRIBE_FAILED)})})},a}(),b=D,m="undefined",y="fcm_token_object_Store";i.prototype.fcmToken,i.prototype.swScope,i.prototype.vapidKey,i.prototype.subscription,i.prototype.fcmSenderId,i.prototype.fcmPushSet;var v=function(a){function b(){return a.call(this,"fcm_token_details_db",2)||this}return c.__extends(b,a),b.prototype.onDBUpgrade=function(a,b){if(1>b.oldVersion){var c=a.createObjectStore("fcm_token_object_Store",{keyPath:"swScope"});c.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),c.createIndex("fcmToken","fcmToken",{unique:!0})}2>b.oldVersion&&n()},b.prototype.n=function(a){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(){return a.fcmToken&&("string"!=typeof a.fcmToken||0===a.fcmToken.length)?[2,Promise.reject(this.e.create(z.codes.BAD_TOKEN))]:a.swScope&&("string"!=typeof a.swScope||0===a.swScope.length)?[2,Promise.reject(this.e.create(z.codes.BAD_SCOPE))]:!a.vapidKey||a.vapidKey instanceof Uint8Array&&65===a.vapidKey.length?!a.subscription||a.subscription instanceof PushSubscription?a.fcmSenderId&&("string"!=typeof a.fcmSenderId||0===a.fcmSenderId.length)?[2,Promise.reject(this.e.create(z.codes.BAD_SENDER_ID))]:a.fcmPushSet&&("string"!=typeof a.fcmPushSet||0===a.fcmPushSet.length)?[2,Promise.reject(this.e.create(z.codes.BAD_PUSH_SET))]:[2]:[2,Promise.reject(this.e.create(z.codes.BAD_SUBSCRIPTION))]:[2,Promise.reject(this.e.create(z.codes.BAD_VAPID_KEY))]})})},b.prototype.getTokenDetailsFromToken=function(b){var a=this;return b?this.n({fcmToken:b}).then(function(){return a.openDatabase()}).then(function(c){return new Promise(function(d,f){var e=c.transaction(["fcm_token_object_Store"]),g=e.objectStore("fcm_token_object_Store"),h=g.index("fcmToken"),i=h.get(b);i.onerror=function(a){f(a.target.error)},i.onsuccess=function(a){var b=a.target.result?a.target.result:null;d(b)}})}):Promise.reject(this.e.create(z.codes.BAD_TOKEN))},b.prototype.getTokenDetailsFromSWScope=function(a){var b=this;return a?this.n({swScope:a}).then(function(){return b.openDatabase()}).then(function(b){return new Promise(function(c,d){var e=b.transaction(["fcm_token_object_Store"]),f=e.objectStore("fcm_token_object_Store"),g=f.get(a);g.onerror=function(a){d(a.target.error)},g.onsuccess=function(a){var b=a.target.result?a.target.result:null;c(b)}})}):Promise.reject(this.e.create(z.codes.BAD_SCOPE))},b.prototype.saveTokenDetails=function(b){var d=this,f=b.swScope,g=b.vapidKey,h=b.subscription,j=b.fcmSenderId,k=b.fcmToken,m=b.fcmPushSet;return f?g?h?j?k?m?this.n({swScope:f,vapidKey:g,subscription:h,fcmSenderId:j,fcmToken:k,fcmPushSet:m}).then(function(){return d.openDatabase()}).then(function(b){var e={swScope:f,vapidKey:l(g),endpoint:h.endpoint,auth:l(h.getKey("auth")),p256dh:l(h.getKey("p256dh")),fcmSenderId:j,fcmToken:k,fcmPushSet:m,createTime:Date.now()};return new Promise(function(a,c){var f=b.transaction(["fcm_token_object_Store"],d.TRANSACTION_READ_WRITE),g=f.objectStore("fcm_token_object_Store"),h=g.put(e);h.onerror=function(a){c(a.target.error)},h.onsuccess=function(){a()}})}):Promise.reject(this.e.create(z.codes.BAD_PUSH_SET)):Promise.reject(this.e.create(z.codes.BAD_TOKEN)):Promise.reject(this.e.create(z.codes.BAD_SENDER_ID)):Promise.reject(this.e.create(z.codes.BAD_SUBSCRIPTION)):Promise.reject(this.e.create(z.codes.BAD_VAPID_KEY)):Promise.reject(this.e.create(z.codes.BAD_SCOPE))},b.prototype.deleteToken=function(a){var b=this;return"string"!=typeof a||0===a.length?Promise.reject(this.e.create(z.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(a).then(function(c){if(!c)throw b.e.create(z.codes.DELETE_TOKEN_NOT_FOUND);return b.openDatabase().then(function(d){return new Promise(function(e,f){var g=d.transaction(["fcm_token_object_Store"],b.TRANSACTION_READ_WRITE),h=g.objectStore("fcm_token_object_Store"),i=h.delete(c.swScope);i.onerror=function(a){f(a.target.error)},i.onsuccess=function(a){return 0===a.target.result?void f(b.e.create(z.codes.FAILED_TO_DELETE_TOKEN)):void e(c)}})})})},b}(h),k=function(a){function b(){return a.call(this,"fcm_vapid_details_db",1)||this}return c.__extends(b,a),b.prototype.onDBUpgrade=function(a){a.createObjectStore("fcm_vapid_object_Store",{keyPath:"swScope"})},b.prototype.getVapidFromSWScope=function(a){return"string"!=typeof a||0===a.length?Promise.reject(this.e.create(z.codes.BAD_SCOPE)):this.openDatabase().then(function(b){return new Promise(function(c,d){var e=b.transaction(["fcm_vapid_object_Store"]),f=e.objectStore("fcm_vapid_object_Store"),g=f.get(a);g.onerror=function(){d(g.error)},g.onsuccess=function(){var a=g.result,b=null;a&&(b=a.vapidKey),c(b)}})})},b.prototype.saveVapidDetails=function(a,b){var c=this;if("string"!=typeof a||0===a.length)return Promise.reject(this.e.create(z.codes.BAD_SCOPE));if(null===b||65!==b.length)return Promise.reject(this.e.create(z.codes.BAD_VAPID_KEY));var d={swScope:a,vapidKey:b};return this.openDatabase().then(function(b){return new Promise(function(e,f){var g=b.transaction(["fcm_vapid_object_Store"],c.TRANSACTION_READ_WRITE),h=g.objectStore("fcm_vapid_object_Store"),i=h.put(d);i.onerror=function(){f(i.error)},i.onsuccess=function(){e()}})})},b.prototype.deleteVapidDetails=function(b){var d=this;return this.getVapidFromSWScope(b).then(function(a){if(!a)throw d.e.create(z.codes.DELETE_SCOPE_NOT_FOUND);return d.openDatabase().then(function(e){return new Promise(function(f,g){var h=e.transaction(["fcm_vapid_object_Store"],d.TRANSACTION_READ_WRITE),i=h.objectStore("fcm_vapid_object_Store"),j=i.delete(b);j.onerror=function(){g(j.error)},j.onsuccess=function(){return 0===j.result?void g(d.e.create(z.codes.FAILED_DELETE_VAPID_KEY)):void f(a)}})})})},b}(h),A="messagingSenderId",F=function(){function a(a){var c=this;if(this.e=new u.ErrorFactory("messaging","Messaging",z.map),!a.options[A]||"string"!=typeof a.options[A])throw this.e.create(z.codes.BAD_SENDER_ID);this.i=a.options[A],this.s=new v,this.a=new k,this.c=new b,this.app=a,this.INTERNAL={},this.INTERNAL.delete=function(){return c.delete()}}return a.prototype.getToken=function(){var a=this,b=this.u();if("granted"!==b)return"denied"===b?Promise.reject(this.e.create(z.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null);var c;return this._().then(function(b){return c=b,a.s.getTokenDetailsFromSWScope(c.scope)}).then(function(b){return b?a.manageExistingToken(b,c):a.getNewToken(c)})},a.prototype.manageExistingToken=function(a,b){var c=this;return this.isTokenStillValid(a).then(function(d){return d?Date.now()<a.createTime+6048e5?a.fcmToken:c.updateToken(a,b):c.deleteToken(a.fcmToken).then(function(){return c.getNewToken(b)})})},a.prototype.isTokenStillValid=function(a){return this.d().then(function(b){return l(b)===a.vapidKey})},a.prototype.updateToken=function(b,c){var d,e,f,g=this;return this.d().then(function(a){return d=a,g.p(c,d)}).then(function(a){return f=a,g.c.updateToken(g.i,b.fcmToken,b.fcmPushSet,f,d)}).catch(function(a){return g.deleteToken(b.fcmToken).then(function(){throw a})}).then(function(h){e=h;var i={swScope:c.scope,vapidKey:d,subscription:f,fcmSenderId:g.i,fcmToken:e,fcmPushSet:b.fcmPushSet};return g.s.saveTokenDetails(i)}).then(function(){return g.a.saveVapidDetails(c.scope,d)}).then(function(){return e})},a.prototype.getNewToken=function(a){var b,c,d,f=this;return this.d().then(function(c){return b=c,f.p(a,b)}).then(function(a){return c=a,f.c.getToken(f.i,c,b)}).then(function(e){d=e;var g={swScope:a.scope,vapidKey:b,subscription:c,fcmSenderId:f.i,fcmToken:d.token,fcmPushSet:d.pushSet};return f.s.saveTokenDetails(g)}).then(function(){return f.a.saveVapidDetails(a.scope,b)}).then(function(){return d.token})},a.prototype.deleteToken=function(a){var b=this;return this.s.deleteToken(a).then(function(a){return b.c.deleteToken(a.fcmSenderId,a.fcmToken,a.fcmPushSet)}).then(function(){return b._().then(function(a){if(a)return a.pushManager.getSubscription()}).then(function(a){if(a)return a.unsubscribe()})})},a.prototype._=function(){throw this.e.create(z.codes.SHOULD_BE_INHERITED)},a.prototype.d=function(){throw this.e.create(z.codes.SHOULD_BE_INHERITED)},a.prototype.requestPermission=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.p=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.useServiceWorker=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.usePublicVapidKey=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.onMessage=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.onTokenRefresh=function(){throw this.e.create(z.codes.AVAILABLE_IN_WINDOW)},a.prototype.setBackgroundMessageHandler=function(){throw this.e.create(z.codes.AVAILABLE_IN_SW)},a.prototype.delete=function(){return Promise.all([this.s.closeDatabase(),this.a.closeDatabase()])},a.prototype.u=function(){return Notification.permission},a.prototype.getTokenDetailsModel=function(){return this.s},a.prototype.getVapidDetailsModel=function(){return this.a},a.prototype.getIIDModel=function(){return this.c},a}(),C=F,I={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},J={PARAMS:I,TYPES_OF_MSG:{PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},createNewMsg:function(a,b){return c={},c[I.TYPE_OF_MSG]=a,c[I.DATA]=b,c;var c}},M={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"},K=function(a){for(var b="=".repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,"+").replace(/_/g,"/"),d=window.atob(c),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=d.charCodeAt(f);return e},N=function(a){function b(b){var c=a.call(this,b)||this;return c.f=null,c.h=Object(u.createSubscribe)(function(a){c.f=a}),c.l=null,c.g=Object(u.createSubscribe)(function(a){c.l=a}),c.S,c.T,c.f=null,c.h=Object(u.createSubscribe)(function(a){c.f=a}),c.l=null,c.g=Object(u.createSubscribe)(function(a){c.l=a}),c.b(),c}return c.__extends(b,a),b.prototype.getToken=function(){var b=this;return this.m()?this.y().then(function(){return a.prototype.getToken.call(b)}):Promise.reject(this.e.create(z.codes.UNSUPPORTED_BROWSER))},b.prototype.y=function(){var a=this;if(this.T)return this.T;var b=document.querySelector("link[rel=\"manifest\"]");return this.T=b?fetch(b.href).then(function(a){return a.json()}).catch(function(){}).then(function(b){if(b&&b.gcm_sender_id&&"103953800507"!==b.gcm_sender_id)throw a.e.create(z.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.T},b.prototype.requestPermission=function(){return c.__awaiter(this,void 0,void 0,function(){var a=this;return c.__generator(this,function(){return"granted"===Notification.permission?[2]:[2,new Promise(function(b,c){var d=function(d){return"granted"===d?b():c("denied"===d?a.e.create(z.codes.PERMISSION_BLOCKED):a.e.create(z.codes.PERMISSION_DEFAULT))},e=Notification.requestPermission(d);e&&e.then(d)})]})})},b.prototype.useServiceWorker=function(a){if(!(a instanceof ServiceWorkerRegistration))throw this.e.create(z.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.S)throw this.e.create(z.codes.USE_SW_BEFORE_GET_TOKEN);this.S=a},b.prototype.usePublicVapidKey=function(a){if("string"!=typeof a)throw this.e.create(z.codes.INVALID_PUBLIC_VAPID_KEY);if(void 0!==this.v)throw this.e.create(z.codes.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var b=K(a);if(65!==b.length)throw this.e.create(z.codes.PUBLIC_KEY_DECRYPTION_FAILED);this.v=b},b.prototype.onMessage=function(a,b,c){return this.h(a,b,c)},b.prototype.onTokenRefresh=function(a,b,c){return this.g(a,b,c)},b.prototype.D=function(a){var b=this,c=a.installing||a.waiting||a.active;return new Promise(function(d,e){if(!c)return void e(b.e.create(z.codes.NO_SW_IN_REG));if("activated"===c.state)return void d(a);if("redundant"===c.state)return void e(b.e.create(z.codes.SW_REG_REDUNDANT));var f=function(){if("activated"===c.state)d(a);else{if("redundant"!==c.state)return;e(b.e.create(z.codes.SW_REG_REDUNDANT))}c.removeEventListener("statechange",f)};c.addEventListener("statechange",f)})},b.prototype._=function(){var a=this;return this.S?this.D(this.S):(this.S=null,navigator.serviceWorker.register(M.path,{scope:M.scope}).catch(function(b){throw a.e.create(z.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:b.message})}).then(function(b){return a.D(b).then(function(){return a.S=b,b.update(),b})}))},b.prototype.d=function(){return this.v?Promise.resolve(this.v):Promise.resolve(B.DEFAULT_PUBLIC_VAPID_KEY)},b.prototype.p=function(a,b){return a.pushManager.getSubscription().then(function(c){return c||a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:b})})},b.prototype.b=function(){var a=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(b){if(b.data&&b.data[J.PARAMS.TYPE_OF_MSG]){var c=b.data;switch(c[J.PARAMS.TYPE_OF_MSG]){case J.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case J.TYPES_OF_MSG.NOTIFICATION_CLICKED:var d=c[J.PARAMS.DATA];a.f&&a.f.next(d);}}},!1)},b.prototype.m=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},b}(C),O=N,P=function(a){function b(b){var c=a.call(this,b)||this;return self.addEventListener("push",function(a){return c.I(a)},!1),self.addEventListener("pushsubscriptionchange",function(a){return c.k(a)},!1),self.addEventListener("notificationclick",function(a){return c.w(a)},!1),c.N=null,c}return c.__extends(b,a),b.prototype.I=function(a){var b,c=this;try{b=a.data.json()}catch(a){return}var d=this.P().then(function(a){if(!a){var d=c.O(b);if(d){var f=d.title||"";return c._().then(function(a){return a.showNotification(f,d)})}if(c.N)return c.N(b)}else if(b.notification||c.N)return c.A(b)});a.waitUntil(d)},b.prototype.k=function(a){var b=this,c=this._().then(function(a){return a.pushManager.getSubscription().then(function(){}).catch(function(c){return b.getTokenDetailsModel().getTokenDetailsFromSWScope(a.scope).then(function(a){if(!a)throw c;return b.deleteToken(a.fcmToken).then(function(){throw c})})})}).catch(function(a){throw b.e.create(z.codes.UNABLE_TO_RESUBSCRIBE,{message:a})});a.waitUntil(c)},b.prototype.w=function(a){var b=this;if(a.notification&&a.notification.data&&a.notification.data.FCM_MSG){a.stopImmediatePropagation(),a.notification.close();var c=a.notification.data.FCM_MSG;if(c.notification){var d=c.notification.click_action;if(d){var e=this.F(d).then(function(a){return a?a.focus():self.clients.openWindow(d)}).then(function(a){if(a){c.notification,delete c.notification;var d=J.createNewMsg(J.TYPES_OF_MSG.NOTIFICATION_CLICKED,c);return b.C(a,d)}});a.waitUntil(e)}}}},b.prototype.O=function(a){if(a&&"object"==typeof a.notification){var b=Object.assign({},a.notification);return b.data=(c={},c.FCM_MSG=a,c),b;var c}},b.prototype.setBackgroundMessageHandler=function(a){if(!a||"function"!=typeof a)throw this.e.create(z.codes.BG_HANDLER_FUNCTION_EXPECTED);this.N=a},b.prototype.F=function(a){var b=new URL(a,self.location).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(a){for(var c=null,d=0;d<a.length;d++)if(new URL(a[d].url,self.location).href===b){c=a[d];break}return c||null})},b.prototype.C=function(a,b){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(){return a?(a.postMessage(b),[2]):[2,Promise.reject(this.e.create(z.codes.NO_WINDOW_CLIENT_TO_MSG))]})})},b.prototype.P=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(a){return a.some(function(a){return"visible"===a.visibilityState})})},b.prototype.A=function(a){var b=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(c){var d=J.createNewMsg(J.TYPES_OF_MSG.PUSH_MSG_RECEIVED,a);return Promise.all(c.map(function(a){return b.C(a,d)}))})},b.prototype._=function(){return Promise.resolve(self.registration)},b.prototype.d=function(){var a=this;return this._().then(function(b){return a.getVapidDetailsModel().getVapidFromSWScope(b.scope)}).then(function(a){return null===a?B.DEFAULT_PUBLIC_VAPID_KEY:a})},b}(C),G=P,Q=t(7);e.registerMessaging=s,s(Q.firebase)}},[117])}catch(a){throw Error("Cannot instantiate firebase-messaging.js - be sure to load firebase-app.js first.")}